<!doctype html><html><head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge"><title>Swift Closures: Inline functions explained by a web developer - Thomas Wilson</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Hi, I&rsquo;m Thomas. I&rsquo;m a frontend engineer who&rsquo;s learning swift. Let&rsquo;s talk about closures in Swift from a very (very) introductory level. I&rsquo;m assuming you&rsquo;ve got some familiarity with JavaScript. You should definitely check out Apple&rsquo;s documentation on Closures, it&rsquo;s so much better than this page but also, like, less funny?
Closures are inline function definitions.
We have inline functions all over the place in JavaScript. Callback functions, including those in promises, are often declared in JavaScript:">
<meta property="og:image" content>
<meta property="og:title" content="Swift Closures: Inline functions explained by a web developer">
<meta property="og:description" content="Hi, I&rsquo;m Thomas. I&rsquo;m a frontend engineer who&rsquo;s learning swift. Let&rsquo;s talk about closures in Swift from a very (very) introductory level. I&rsquo;m assuming you&rsquo;ve got some familiarity with JavaScript. You should definitely check out Apple&rsquo;s documentation on Closures, it&rsquo;s so much better than this page but also, like, less funny?
Closures are inline function definitions.
We have inline functions all over the place in JavaScript. Callback functions, including those in promises, are often declared in JavaScript:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://thomaswilson.xyz/blog/2021-02-17-closures-in-swift/"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-02-17T00:00:00+00:00">
<meta property="article:modified_time" content="2021-02-17T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Swift Closures: Inline functions explained by a web developer">
<meta name=twitter:description content="Hi, I&rsquo;m Thomas. I&rsquo;m a frontend engineer who&rsquo;s learning swift. Let&rsquo;s talk about closures in Swift from a very (very) introductory level. I&rsquo;m assuming you&rsquo;ve got some familiarity with JavaScript. You should definitely check out Apple&rsquo;s documentation on Closures, it&rsquo;s so much better than this page but also, like, less funny?
Closures are inline function definitions.
We have inline functions all over the place in JavaScript. Callback functions, including those in promises, are often declared in JavaScript:">
<script src=https://thomaswilson.xyzjs/feather.min.js></script>
<link href=https://thomaswilson.xyz/css/fonts.511ddb4c3eb5cc664ffce964174cebefda4d808569e219a7e5188466aa7713e6.css rel=stylesheet>
<link rel=stylesheet type=text/css media=screen href=https://thomaswilson.xyz/css/main.ecd799717c3d0b98bb2dca9498befc813ebe08241cce8dece74ccadb7dadced1.css>
<link id=darkModeStyle rel=stylesheet type=text/css href=https://thomaswilson.xyz/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)">
</head>
<body>
<div class=content><header>
<div class=main>
<a href=https://thomaswilson.xyz>Thomas Wilson</a>
</div>
<nav>
<a href=/blog>Blog</a>
<a href=/book-reviews>Book reviews</a>
</nav>
</header>
<main>
<article>
<div class=title>
<h1 class=title>Swift Closures: Inline functions explained by a web developer</h1>
<div class=meta>Posted on Feb 17, 2021</div>
</div>
<section class=body>
<p>Hi, I&rsquo;m Thomas. I&rsquo;m a frontend engineer who&rsquo;s learning swift. Let&rsquo;s talk about <em>closures</em> in Swift from a very (very) introductory level. I&rsquo;m assuming you&rsquo;ve got some familiarity with JavaScript. You should definitely check out <a href=https://docs.swift.org/swift-book/LanguageGuide/Closures.html>Apple&rsquo;s documentation on Closures</a>, it&rsquo;s <em>so</em> much better than this page but also, like, less funny?</p>
<p>Closures are inline function definitions.</p>
<p>We have inline functions all over the place in JavaScript. Callback functions, including those in promises, are often declared in JavaScript:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// Ever written an express routers?
</span><span style=color:#75715e></span><span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>use</span>(<span style=color:#e6db74>&#39;/users&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>, <span style=color:#a6e22e>next</span>) =&gt; { .. })

<span style=color:#75715e>// Ever write a promise?
</span><span style=color:#75715e></span><span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;https://www.google.com&#34;</span>).<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>res</span>) =&gt; { .. })
</code></pre></div><p>Like JavaScript, Swift has functions as a first-class citizen. That means they can be passed around like any other variable. That&rsquo;s pretty cool, and if you come from a pure JS background you might not realise it. You might think it&rsquo;s pretty annoying. But it&rsquo;s not. Try filtering a dataframe into a subset in Python using Pandas without the <code>filter</code>-like function syntax (don&rsquo;t @ me).</p>
<p>We use closures in Swift in exactly the same use case: when we need to pass a function as an argument to a function. For example, if we are passing a custom <code>sort</code>, <code>map</code>, or <code>sorted</code> function on an array.</p>
<p>In the same mental model that React uses, a SwiftUI View is like a React component: it&rsquo;s fundamentally a function: <code>f(state) => ui</code> - UI is a function of state.</p>
<p>Understanding Closures in swift will help you write, and read, SwiftUI examples.</p>
<p>The name&rsquo;s a little confusing. In JavaScript a <em>closure</em> is the scope at which a function is declared and its relationship to the surrounding variables. Coming from JS, I had a little trouble getting my head around them.</p>
<h2 id=ground-0-function-declarations>Ground 0: Function Declarations</h2>
<p>Defining inline, full-blooded functions in Swift is pretty standard, and could probably be intuited by any engineer with one or two languages under their hat:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>multiply</span>(number: Int, by:Int) -&gt; Int {
	<span style=color:#66d9ef>return</span> number <span style=color:#f92672>*</span> b
}
</code></pre></div><p>It would be perfectly valid syntax to pass this function around by simply referencing its identifier (<code>multiply</code>).</p>
<h2 id=removing-some-syntax>Removing some syntax</h2>
<p>But what if we don&rsquo;t want to have to declare named functions everywhere. Especially if we&rsquo;re literally just going to use it once?</p>
<p>In JavaScript you define the function inline with the same syntax as you would anywhere else. BUT NOT IN SWIFT. Why? I don&rsquo;t know, friend, by let&rsquo;s explore the <em>what</em> not the <em>why</em> first.</p>
<p>Swift comes with a set of <strong>syntactical sugar</strong> for declaring closures. Syntactical sugar is a way of making code shorter or more readable. Syntactical sugar often replaces boilerplate or verbose code, and results in identical functionality to its un-sugared sibling.</p>
<p>This syntactical sugar looks like:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift>	{ (parameters) -&gt; ReturnType <span style=color:#66d9ef>in</span>
		<span style=color:#75715e>// expression</span>
	}
</code></pre></div><p>Let&rsquo;s give a <em>real</em> simple example. We&rsquo;re going to take an array of <code>Int</code> and convert it to an <code>Array&lt;String></code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> strings: Array&lt;String&gt; = [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>].map({ (n: Int) -&gt; String <span style=color:#66d9ef>in</span>
	<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;The number is </span><span style=color:#e6db74>\(</span>n<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>
})
</code></pre></div><h2 id=the-in-keyword>The <code>in</code> keyword</h2>
<p>This syntax looked odd to me. The key (pun intended) to me grokking it was understanding the <code>in</code> keyword. Typically I have only seen this associated with iterators (in languages like python and JS):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># This is Python code</span>
<span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> list_of_name:
	print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hello, </span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</code></pre></div><p>In Closures, in Swift, <strong>the <code>in</code> keyword signifies that we&rsquo;ve reached the end of our parameter and return type. Everything after the <code>in</code> is the action function expression.</strong></p>
<h2 id=implicit-types-for-even-less-syntax>Implicit Types for Even Less Syntax</h2>
<p>You better believe that&rsquo;s not all the syntactic sugar. There&rsquo;s still stuff we&rsquo;re going to get rid of.</p>
<p>Once we declare types in one place, e.g. in a variable, generic, parameter, then we don&rsquo;t need to duplicate that typing. We <em>can</em> but we don&rsquo;t have to.</p>
<p>Swift is able to find the implied types elsewhere in the code, and therefore we can remove them in the closure.</p>
<p>In the following example the <code>boastfulString</code> variable is declared as the <code>Array&lt;String></code> type, so the map function doesn&rsquo;t need to be told twice:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> boastfulStrings: Array&lt;String&gt; = [<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>30</span>,<span style=color:#ae81ff>40</span>,<span style=color:#ae81ff>50</span>].map( { n <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;I have </span><span style=color:#e6db74>\(</span>n<span style=color:#e6db74>)</span><span style=color:#e6db74> tacos!&#34;</span>})
</code></pre></div><p>By using implicit types we can get rid of two redundant parts of the closure declaration.</p>
<ul>
<li>
<p><strong>The surrounding parentheses for the parameters:</strong> <code>(n: Int)</code> becomes <code>n</code>). We can do the same with multiple parameters: Say we had an argument that took three parameters: <code>(name: String, age: Int, averageScore: Float) ..</code> could become <code>name, age, averageScore ..</code></p>
</li>
<li>
<p><strong>The return type of the closure</strong>: We know the function needs to return us a <code>String</code>, it&rsquo;s in the variable declaration. So <code>(n: Int) -> Int in ..</code> can become <code>n -> ..</code></p>
</li>
</ul>
<p>Swift is super ready for you to give it an <code>Array&lt;String></code> and will actually get pretty mad if you dont'. You&rsquo;ll run into compile-time errors with anything else.</p>
<h2 id=implicit-returns>Implicit Returns</h2>
<p>Man, talking of redundancies, that <code>return</code> doesn&rsquo;t look like it&rsquo;s doing much on that one line there. JS, Ruby, and Rust all have implicit return types - and so does Swift. That means you don&rsquo;t need to use the <code>return</code> keyword to tell Swift &ldquo;this is the bed that the function should hand back&rdquo;.</p>
<p>This is more syntactic sugar: we&rsquo;re choosing conciseness and simplicity over explicit and verbose. Having <code>return</code> or omitting it in this example does exactly the same thing. You don&rsquo;t have to like this, or us it in your code. It&rsquo;s your choice, but you should definitely know about it. Also it&rsquo;s probably useful in those scenarios where you <em>just need something to work</em>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> boastfulStrings: Array&lt;String&gt; = [<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>200</span>].map( { n <span style=color:#66d9ef>in</span> <span style=color:#e6db74>&#34;I have </span><span style=color:#e6db74>\(</span>n<span style=color:#e6db74>)</span><span style=color:#e6db74> taco!&#34;</span> })
</code></pre></div><p>Look how concise that statement is.</p>
<h2 id=shorthand-argument-names-spend-those->Shorthand Argument Names: spend those $</h2>
<p>But we can be more concise.</p>
<p>What else can we get rid of?</p>
<p>That named parameter, <code>n</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> regretfulStrings: Array&lt;String&gt; = [<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>8</span>].map( { <span style=color:#e6db74>&#34;I ate </span><span style=color:#e6db74>\(</span>$0<span style=color:#e6db74>)</span><span style=color:#e6db74> too many tacos ):&#34;</span> })
</code></pre></div><p>These are <strong>shorthand arguments</strong>. Where <code>$0</code> refers to the first argument in the function. <code>$1</code> to the second argument, <code>$2</code> to the third&mldr;</p>
<p>Now we&rsquo;re <em>really</em> favouring conciseness over explicitness.</p>
</section>
<div class=post-tags>
<nav class="nav tags">
<ul class=tags>
<li><a href=/tags/swift>swift</a></li>
</ul>
</nav>
</div>
</article>
</main>
<footer>
<hr>
2021
© Thomas Wilson
</footer>
</div>
</body>
</html>